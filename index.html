<!DOCTYPE html>
<html>
<head>
    <title>Sistema Solar(vr)</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script>
        // Componente para √≥rbitas circulares
        AFRAME.registerComponent('orbit', {
            schema: {
                radius: {type: 'number', default: 25},
                speed: {type: 'number', default: 0.2}, // Reducido para traslaci√≥n m√°s lenta
                startAngle: {type: 'number', default: 0}
            },
            init: function() {
                this.angle = this.data.startAngle;
                this.center = new THREE.Vector3(0, 2, 0);
            },
            tick: function(time, deltaTime) {
                this.angle += (this.data.speed * deltaTime) / 1000;
                const x = this.center.x + this.data.radius * Math.cos(this.angle);
                const z = this.center.z + this.data.radius * Math.sin(this.angle);
                this.el.setAttribute('position', {x: x, y: this.center.y, z: z});
            }
        });

        // Componente para crear estrellas lejanas (OPTIMIZADO)
        AFRAME.registerComponent('starfield', {
            init: function() {
                const scene = this.el;
                // Reducir de 5000 a 1000 estrellas para mejor performance
                for (let i = 0; i < 1000; i++) {
                    const star = document.createElement('a-sphere');
                    // Posici√≥n aleatoria en una esfera muy lejana y dispersa
                    const radius = 8000 + Math.random() * 8000;
                    const theta = Math.random() * Math.PI * 2;
                    const phi = Math.acos(Math.random() * 2 - 1);
                    const x = radius * Math.sin(phi) * Math.cos(theta);
                    const y = radius * Math.sin(phi) * Math.sin(theta);
                    const z = radius * Math.cos(phi);
                    star.setAttribute('position', `${x} ${y} ${z}`);
                    star.setAttribute('radius', '8'); // Reducir tama√±o
                    // Material m√°s simple
                    star.setAttribute('material', `shader: flat; color: #ffffff; emissive: #ffffff; emissiveIntensity: 8`);
                    scene.appendChild(star);
                }
            }
        });

        // Componente para √≥rbita de la luna alrededor de la Tierra
        AFRAME.registerComponent('luna-orbit', {
            schema: {
                radius: {type: 'number', default: 800},
                speed: {type: 'number', default: 0.06}, // Reducido para traslaci√≥n m√°s lenta
                startAngle: {type: 'number', default: 0}
            },
            init: function() {
                this.angle = this.data.startAngle;
            },
            tick: function(time, deltaTime) {
                this.angle += (this.data.speed * deltaTime) / 1000;
                // Como la Luna es hija de la Tierra, orbita respecto al origen local
                const x = this.data.radius * Math.cos(this.angle);
                const z = this.data.radius * Math.sin(this.angle);
                this.el.setAttribute('position', {
                    x: x,
                    y: 0,
                    z: z
                });
            }
        });





        // Componente para aplicar texturas al modelo de Saturno
        AFRAME.registerComponent('saturn-textures', {
            init: function() {
                this.el.addEventListener('model-loaded', () => {
                    const model = this.el.getObject3D('mesh');
                    if (model) {
                        console.log('Modelo cargado, aplicando texturas...');
                        model.traverse((child) => {
                            if (child.isMesh) {
                                console.log('Encontrado mesh:', child.name, 'Material:', child.material.name);
                                const material = child.material;
                                if (material) {
                                    const textureLoader = new THREE.TextureLoader();
                                    
                                    // Aplicar textura de Saturno al planeta (primer material)
                                    if (material.name === 'Material.002' || child.name.includes('Material.002')) {
                                        console.log('Aplicando textura de planeta a:', child.name);
                                        textureLoader.load('assets/saturn/textures/Material.002_diffuse.jpeg', (texture) => {
                                            material.map = texture;
                                            material.needsUpdate = true;
                                            console.log('Textura de planeta aplicada');
                                        });
                                    }
                                    // Aplicar textura de anillos (segundo material)
                                    else if (material.name.includes('ring') || child.name.includes('ring') || child.name.includes('rings')) {
                                        console.log('Aplicando textura de anillos a:', child.name);
                                        textureLoader.load('assets/saturn/textures/ring_diffuse.jpeg', (texture) => {
                                            material.map = texture;
                                            material.needsUpdate = true;
                                            console.log('Textura de anillos aplicada');
                                        });
                                    }
                                    // Si no coincide con ninguno, aplicar textura de planeta por defecto
                                    else {
                                        console.log('Aplicando textura de planeta por defecto a:', child.name);
                                        textureLoader.load('assets/saturn/textures/Material.002_diffuse.jpeg', (texture) => {
                                            material.map = texture;
                                            material.needsUpdate = true;
                                            console.log('Textura de planeta aplicada por defecto');
                                        });
                                    }
                                }
                            }
                        });
                    }
                });
            }
        });

        // Componente para movimiento del OVNI entre planetas (OPTIMIZADO)
        AFRAME.registerComponent('ufo-patrol', {
            schema: {
                speed: {type: 'number', default: 0.02} // Velocidad m√°s lenta
            },
            init: function() {
                this.time = 0;
                this.currentTarget = 0;
                
                // Posiciones de los planetas para visitar
                this.planets = [
                    {x: 2000, y: 2, z: 0},      // Mercurio
                    {x: -3200, y: 2, z: 0},     // Venus
                    {x: 0, y: 2, z: 4800},      // Tierra
                    {x: -4215.99302, y: 2, z: 3337.77691}, // Marte
                    {x: 8000, y: 2, z: 0},      // J√∫piter
                    {x: -10000, y: 2, z: 0},    // Saturno
                    {x: 0, y: 2, z: 12000},     // Urano
                    {x: 0, y: 2, z: -8570.32149} // Neptuno
                ];
                
                this.currentPos = {x: 0, y: 2, z: 3000}; // Posici√≥n inicial
            },
            tick: function(time, deltaTime) {
                this.time += deltaTime * this.data.speed;
                
                // Calcular posici√≥n actual basada en el tiempo
                const totalPlanets = this.planets.length;
                const timePerPlanet = 12000; // 12 segundos por planeta
                const currentTime = this.time % (totalPlanets * timePerPlanet);
                const currentPlanetIndex = Math.floor(currentTime / timePerPlanet);
                const nextPlanetIndex = (currentPlanetIndex + 1) % totalPlanets;
                const progress = (currentTime % timePerPlanet) / timePerPlanet;
                
                const currentPlanet = this.planets[currentPlanetIndex];
                const nextPlanet = this.planets[nextPlanetIndex];
                
                // Interpolaci√≥n suave entre planetas
                const x = currentPlanet.x + (nextPlanet.x - currentPlanet.x) * progress;
                const y = currentPlanet.y + 500 + Math.sin(this.time * 0.0008) * 200;
                const z = currentPlanet.z + (nextPlanet.z - currentPlanet.z) * progress;
                
                this.el.setAttribute('position', {x: x, y: y, z: z});
                
                // Hacer que el OVNI mire hacia el planeta actual
                const lookAt = new THREE.Vector3(currentPlanet.x, currentPlanet.y, currentPlanet.z);
                const ufoPos = new THREE.Vector3(x, y, z);
                const direction = lookAt.sub(ufoPos).normalize();
                const angle = Math.atan2(direction.x, direction.z) * (180 / Math.PI);
                this.el.setAttribute('rotation', {x: 0, y: angle, z: 0});
            }
        });

        // Componente para aplicar texturas al OVNI
        AFRAME.registerComponent('ufo-textures', {
            init: function() {
                this.el.addEventListener('model-loaded', () => {
                    const model = this.el.getObject3D('mesh');
                    if (model) {
                        console.log('OVNI cargado, aplicando materiales...');
                        model.traverse((child) => {
                            if (child.isMesh) {
                                console.log('OVNI mesh encontrado:', child.name);
                                const material = child.material;
                                if (material) {
                                    // Crear un nuevo material con colores met√°licos para el OVNI
                                    const newMaterial = new THREE.MeshStandardMaterial({
                                        color: 0x444444, // Gris met√°lico oscuro
                                        metalness: 0.8,
                                        roughness: 0.2,
                                        emissive: 0x222222,
                                        emissiveIntensity: 0.1,
                                        side: THREE.DoubleSide
                                    });
                                    
                                    // Aplicar el nuevo material
                                    child.material = newMaterial;
                                    child.material.needsUpdate = true;
                                    
                                    console.log('Nuevo material aplicado al OVNI');
                                }
                            }
                        });
                    }
                });
            }
        });

        // Componente para botones informativos de planetas (SIMPLIFICADO)
        AFRAME.registerComponent('planet-info', {
            schema: {
                planet: {type: 'string', default: 'tierra'}
            },
            init: function() {
                // Agregar evento de click directamente
                this.el.addEventListener('click', (event) => {
                    event.stopPropagation();
                    event.preventDefault();
                    console.log('Click en bot√≥n de planeta:', this.data.planet, 'Elemento:', this.el.id);
                    this.showInfo();
                });
            },
            showInfo: function() {
                const planet = this.data.planet;
                const data = this.infoData[planet];
                
                console.log('Mostrando informaci√≥n para planeta:', planet);
                
                if (data) {
                    // Crear o actualizar el panel de informaci√≥n
                    let infoPanel = document.getElementById('planet-info-panel');
                    if (!infoPanel) {
                        infoPanel = document.createElement('div');
                        infoPanel.id = 'planet-info-panel';
                        infoPanel.style.cssText = `
                            position: fixed;
                            top: 50%;
                            left: 50%;
                            transform: translate(-50%, -50%);
                            background: rgba(0, 0, 0, 0.9);
                            color: white;
                            padding: 30px;
                            border-radius: 15px;
                            border: 2px solid #444;
                            max-width: 500px;
                            z-index: 1000;
                            font-family: Arial, sans-serif;
                            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
                        `;
                        document.body.appendChild(infoPanel);
                    }
                    
                    infoPanel.innerHTML = `
                        <h2 style="color: ${data.color}; margin: 0 0 15px 0; font-size: 24px;">${data.title}</h2>
                        <p style="margin: 0; line-height: 1.6; font-size: 16px;">${data.info}</p>
                        <button onclick="this.parentElement.remove()" style="
                            background: #444;
                            color: white;
                            border: none;
                            padding: 10px 20px;
                            margin-top: 15px;
                            border-radius: 5px;
                            cursor: pointer;
                            font-size: 14px;
                        ">Cerrar</button>
                    `;
                    // Asegurar que el bot√≥n de cerrar funcione siempre
                    document.getElementById('close-info-btn').onclick = function() {
                      document.getElementById('planet-info-panel').style.display = 'none';
                    };
                } else {
                    console.error('No se encontr√≥ informaci√≥n para el planeta:', planet);
                }
            }
        });

        // Componente para desactivar clicks en planetas
        AFRAME.registerComponent('no-click', {
            init: function() {
                // Desactivar completamente los eventos de click en este elemento
                this.el.addEventListener('click', (event) => {
                    event.stopPropagation();
                    event.preventDefault();
                    console.log('Click bloqueado en planeta:', this.el.id);
                    return false;
                });
                
                // Desactivar tambi√©n eventos de mouseenter y mouseover
                this.el.addEventListener('mouseenter', (event) => {
                    event.stopPropagation();
                    event.preventDefault();
                    console.log('Mouseenter bloqueado en planeta:', this.el.id);
                    return false;
                });
                
                this.el.addEventListener('mouseover', (event) => {
                    event.stopPropagation();
                    event.preventDefault();
                    console.log('Mouseover bloqueado en planeta:', this.el.id);
                    return false;
                });
                
                // Desactivar completamente el cursor para este elemento
                this.el.setAttribute('cursor', 'rayOrigin: none');
                
                // Agregar clase para CSS
                this.el.classList.add('no-interaction');
                
                // Desactivar tambi√©n el componente de cursor de A-Frame
                this.el.removeAttribute('cursor');
                
                // Hacer el elemento completamente no interactivo
                this.el.setAttribute('class', 'no-interaction');
            }
        });

        // Componente para debug de clicks
        AFRAME.registerComponent('click-debug', {
            init: function() {
                this.el.addEventListener('click', (event) => {
                    console.log('DEBUG CLICK - Elemento clickeado:', this.el.id || this.el.tagName, 'Planeta configurado:', this.el.getAttribute('planet-info')?.planet || 'NONE');
                    console.log('DEBUG CLICK - Evento completo:', event);
                });
            }
        });

        // Componente para desactivar completamente la interactividad
        AFRAME.registerComponent('disable-interaction', {
            init: function() {
                // Remover cualquier atributo de cursor
                this.el.removeAttribute('cursor');
                
                // Desactivar todos los eventos de mouse
                const events = ['click', 'mouseenter', 'mouseover', 'mouseleave', 'mousedown', 'mouseup'];
                events.forEach(eventType => {
                    this.el.addEventListener(eventType, (event) => {
                        event.stopPropagation();
                        event.preventDefault();
                        console.log(`Evento ${eventType} bloqueado en:`, this.el.id);
                        return false;
                    });
                });
                
                // Hacer el elemento completamente no interactivo
                this.el.setAttribute('class', 'no-interaction');
                
                // Desactivar el raycasting para este elemento
                this.el.setAttribute('cursor', 'rayOrigin: none');
                
                console.log('Interactividad desactivada para:', this.el.id);
            }
        });

        // Componente para aplicar color amarillo y luz al modelo de signo de interrogaci√≥n
        AFRAME.registerComponent('question-mark-glow', {
            init: function() {
                this.el.addEventListener('model-loaded', () => {
                    const model = this.el.getObject3D('mesh');
                    if (model) {
                        console.log('Modelo de signo de interrogaci√≥n cargado, aplicando color amarillo...');
                        model.traverse((child) => {
                            if (child.isMesh) {
                                console.log('Aplicando material amarillo a:', child.name);
                                const material = child.material;
                                if (material) {
                                    // Aplicar color amarillo brillante
                                    material.color.setHex(0xFFFF00); // Amarillo
                                    material.emissive.setHex(0xFFFF00); // Emisi√≥n amarilla
                                    material.emissiveIntensity = 0.5; // Intensidad de emisi√≥n
                                    material.metalness = 0.8;
                                    material.roughness = 0.2;
                                    material.needsUpdate = true;
                                    
                                    console.log('Material amarillo aplicado');
                                }
                            }
                        });
                    }
                });
            }
        });

        // Componente para asegurar que los botones sean clickeables
        AFRAME.registerComponent('clickable-button', {
            init: function() {
                // Asegurar que el elemento tenga cursor
                this.el.setAttribute('cursor', 'rayOrigin: mouse');
                
                // Agregar evento de click adicional
                this.el.addEventListener('click', (event) => {
                    console.log('Click detectado en bot√≥n clickeable:', this.el.id);
                });
                
                // Agregar evento de mouseenter para feedback visual
                this.el.addEventListener('mouseenter', () => {
                    console.log('Mouse sobre bot√≥n:', this.el.id);
                });
            }
        });

        // Funci√≥n para salir del pointer lock
        function exitPointerLock() {
          if (document.exitPointerLock) {
            document.exitPointerLock();
          } else if (document.mozExitPointerLock) {
            document.mozExitPointerLock();
          } else if (document.webkitExitPointerLock) {
            document.webkitExitPointerLock();
          }
        }
        // Funci√≥n para volver a entrar en pointer lock
        function requestPointerLock() {
          var scene = document.querySelector('a-scene').canvas;
          if (scene && scene.requestPointerLock) {
            scene.requestPointerLock();
          } else if (scene && scene.mozRequestPointerLock) {
            scene.mozRequestPointerLock();
          } else if (scene && scene.webkitRequestPointerLock) {
            scene.webkitRequestPointerLock();
          }
        }
        // Hook para panel informativo de planetas
        (function(){
          const origShowInfo = AFRAME.components['planet-info'].Component.prototype.showInfo;
          AFRAME.components['planet-info'].Component.prototype.showInfo = function() {
            exitPointerLock();
            origShowInfo.apply(this, arguments);
            // Al mostrar el panel, salir del pointer lock
            setTimeout(exitPointerLock, 100);
            // Al cerrar el panel, volver a pointer lock
            setTimeout(function() {
              const panel = document.getElementById('planet-info-panel');
              if (panel) {
                const closeBtn = panel.querySelector('button');
                if (closeBtn) {
                  closeBtn.addEventListener('click', function() {
                    setTimeout(requestPointerLock, 200);
                  });
                }
              }
            }, 200);
          };
        })();

        // Componente para hacer que el Sol brille m√°s
        AFRAME.registerComponent('sun-glow', {
          init: function() {
            this.el.addEventListener('model-loaded', () => {
              const model = this.el.getObject3D('mesh');
              if (model) {
                model.traverse((child) => {
                  if (child.isMesh && child.material) {
                    // Amarillo intenso y brillo fuerte
                    
                    child.material.emissiveIntensity = 1.8; // Brillo moderado
                    child.material.emissive = new THREE.Color(0xFFFACD); // Amarillo claro
                    // child.material.color = new THREE.Color(0xFFD700); // Puedes dejarlo comentado si quieres conservar la textura original
                    child.material.needsUpdate = true;
                  }
                });
              }
            });
          }
        });

        AFRAME.registerComponent('urano-textura', {
          init: function() {
            this.el.addEventListener('model-loaded', () => {
              const model = this.el.getObject3D('mesh');
              if (model) {
                const textureLoader = new THREE.TextureLoader();
                const textures = [
                  'src/uranus/material_0_baseColor.jpeg',
                  'src/uranus/material_0_metallicRoughness.png',
                  'src/uranus/material_1_baseColor.png'
                ];
                textures.forEach((texPath) => {
                  textureLoader.load(texPath, (texture) => {
                    model.traverse((child) => {
                      if (child.isMesh && child.material && !child.material.map) {
                        child.material.map = texture;
                        child.material.needsUpdate = true;
                      }
                    });
                  });
                });
              }
            });
          }
        });


    </script>
  <link rel="stylesheet" crossorigin href="/Planetario-VR-/assets/index-Dxga3AMg.css">
</head>
<body>
    <!-- Eliminar el crosshair -->
    <!-- Eliminar el div y el style del crosshair -->
    <a-scene background="color: #000011" 
              renderer="far: 10000000; near: 0.00000000001; antialias: false; powerPreference: high-performance; precision: mediump"
              vr-mode-ui="enabled: false"
              inspector="url: https://cdn.jsdelivr.net/gh/aframevr/aframe-inspector@master/dist/aframe-inspector.min.js"
              raycaster="objects: .interactivo">

        <!-- Eliminar el men√∫ inicial de bienvenida -->
        <!-- Eliminar el div con id="pantalla-inicio" y su l√≥gica JS -->

        <!-- Pantalla de pausa -->
        <!-- Eliminar el div con id="pantalla-pausa" y toda la l√≥gica JS asociada a la pausa (mostrarPausa, ocultarPausa, btnContinuar, etc). -->

        <!-- Campo de estrellas cercanas -->
        <a-entity starfield></a-entity>


        <!-- Configuraci√≥n del entorno -->
        <a-assets>
            <!-- Texturas para las paredes -->
            <img id="wallTexture" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==">
            <!-- Textura del Sol -->
            <img id="sunTexture" src="assets/8k_sun-Cutma8LX.jpg">
            <!-- Textura del fondo estrellado -->
            <img id="starsTexture" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==">
            <!-- Texturas de planetas -->
            <img id="tierraTexture" src="assets/textures/8081_earthmap10k.jpg">
            <img id="lunaTexture" src="assets/textures/moon_baseColor.jpeg">
            <img id="mercurioTexture" src="assets/textures/mercury_baseColor.jpeg">
            <img id="venusTexture" src="assets/textures/venus_baseColor.jpeg">
            <img id="saturnoTexture" src="assets/textures/saturn_baseColor.jpeg">
            <img id="saturnRingsTexture" src="assets/textures/saturn_ring_baseColor.png">
            <img id="uranusTexture" src="assets/textures/uranus_baseColor.jpeg">
            <img id="neptuneTexture" src="assets/textures/neptune_baseColor.jpeg">
            <img id="marsTexture" src="assets/textures/mars_baseColor.jpeg">
            <img id="jupiterTexture" src="assets/textures/jupiter_baseColor.jpeg">
            <!-- Modelo 3D de Saturno -->
            <a-asset-item id="saturnModel" src="assets/saturn/scene.gltf"></a-asset-item>
            <!-- Texturas del modelo Saturno -->
            <img id="saturnModelDiffuse" src="assets/saturn/textures/Material.002_diffuse.jpeg">
            <img id="saturnModelRing" src="assets/saturn/textures/ring_diffuse.jpeg">
            <!-- Modelo 3D del OVNI de Bob Lazar -->
            <a-asset-item id="bobLazarUfo" src="assets/bob_lazar_ufo.glb"></a-asset-item>
            <!-- Modelo 3D del signo de interrogaci√≥n -->
            <a-asset-item id="questionMarkModel" src="assets/bob_lazar_ufo.glb"></a-asset-item>
            <a-asset-item id="sunModel" src="assets/sun.glb"></a-asset-item>
            <a-asset-item id="meteoriteModel" src="assets/bob_lazar_ufo.glb"></a-asset-item>
        </a-assets>



        <!-- Pared trasera -->
        <a-plane 
            position="0 2 -5" 
            rotation="0 0 0" 
            width="10" 
            height="4" 
            color="#8B4513"
            material="src: #wallTexture; repeat: 2 1">
        </a-plane>

        <!-- Pared frontal -->
        <a-plane 
            position="0 2 5" 
            rotation="0 180 0" 
            width="10" 
            height="4" 
            color="#8B4513"
            material="src: #wallTexture; repeat: 2 1">
        </a-plane>

        <!-- Pared izquierda -->
        <a-plane 
            position="-5 2 0" 
            rotation="0 90 0" 
            width="10" 
            height="4" 
            color="#8B4513"
            material="src: #wallTexture; repeat: 2 1">
        </a-plane>

        <!-- Pared derecha -->
        <a-plane 
            position="5 2 0" 
            rotation="0 -90 0" 
            width="10" 
            height="4" 
            color="#8B4513"
            material="src: #wallTexture; repeat: 2 1">
        </a-plane>

        <!-- Piso -->
        <a-plane 
            position="0 0 0" 
            rotation="-90 0 0" 
            width="10" 
            height="10" 
            color="#654321">
        </a-plane>

        <!-- Techo -->
        <a-plane 
            position="0 4 0" 
            rotation="90 0 0" 
            width="10" 
            height="10" 
            color="#696969">
        </a-plane>

        <!-- Luz ambiental suave para evitar sombras muy duras -->
        <a-light type="ambient" color="#ffffff" intensity="0.1"></a-light>

        <!-- C√°mara del usuario (justo al lado izquierdo de la Tierra, apuntando al sol) -->
        <a-entity position="400 2 4800">
            <a-camera look-controls="enabled: true; touchEnabled: true; pointerLockEnabled: false" wasd-controls="enabled: true; acceleration: 8000; fly: true" cursor="rayOrigin: mouse"></a-camera>
        </a-entity>

        <!-- SISTEMA SOLAR GIGANTE CON √ìRBITAS REALISTAS -->
        
        <!-- Sol (centro) con modelo GLTF -->
        <a-entity 
            id="sol-nucleo"
            position="0 2 0" 
            scale="100 100 100"
            gltf-model="#sunModel"
            animation="property: rotation; to: 0 360 0; dur: 60000; loop: true; easing: linear"
            class="interactivo"
            sun-glow>
        </a-entity>

        <!-- Luz del sol (puntual) - BLANCA -->
        <a-light 
            id="luz-sol-puntual"
            type="point" 
            position="0 2 0"
            color="#ffe0cc" 
            intensity="2" 
            distance="1000000"
            decay="0.1">
        </a-light>

        <!-- Luz ambiental suave -->
        <a-light 
            id="luz-ambiental"
            type="ambient" 
            color="#ffffff" 
            intensity="0.05">
        </a-light>

        <!-- Mercurio -->
        <a-sphere 
            id="planeta-mercurio"
            radius="200"
            material="src: #mercurioTexture; shader: standard; metalness: 0.6; roughness: 0.9; envMapIntensity: 1.2; emissive: #696969; emissiveIntensity: 0.01"
            animation="property: rotation; to: 0 360 0; dur: 60000; loop: true; easing: linear"
            planet-info="planet: mercurio"
            class="interactivo"
            orbit="radius: 2000; speed: 0.03; startAngle: 0">
        </a-sphere>

        <!-- Venus -->
        <a-sphere 
            id="planeta-venus"
            radius="250"
            material="src: #venusTexture; shader: standard; metalness: 0.2; roughness: 0.85; envMapIntensity: 1.1; emissive: #daa520; emissiveIntensity: 0.02"
            animation="property: rotation; to: 0 360 0; dur: 30000; loop: true; easing: linear"
            planet-info="planet: venus"
            class="interactivo"
            orbit="radius: 3200; speed: 0.025; startAngle: 0.5">
        </a-sphere>

        <!-- Tierra (con √≥rbita alrededor del Sol) -->
        <a-sphere 
            id="planeta-tierra"
            radius="300"
            material="src: #tierraTexture; shader: standard; metalness: 0.1; roughness: 0.9; envMapIntensity: 1.3; emissive: #228b22; emissiveIntensity: 0.01"
            animation="property: rotation; to: 0 360 0; dur: 40000; loop: true; easing: linear"
            planet-info="planet: tierra"
            class="interactivo"
            orbit="radius: 4800; speed: 0.02; startAngle: 1.2">

            <!-- Luna (hija de la Tierra, con √≥rbita propia) -->
            <a-sphere 
                id="satelite-luna"
                radius="80"
                material="src: #lunaTexture; shader: standard; metalness: 0.1; roughness: 0.95; envMapIntensity: 1.0; emissive: #c0c0c0; emissiveIntensity: 0.005"
                animation="property: rotation; to: 0 360 0; dur: 120000; loop: true; easing: linear"
                luna-orbit="radius: 800; speed: 0.06; startAngle: 0"
                planet-info="planet: luna"
                class="interactivo">
            </a-sphere>
        </a-sphere>

        <!-- Marte -->
        <a-sphere 
            id="planeta-marte"
            radius="220"
            material="src: #marsTexture; shader: standard; metalness: 0.15; roughness: 0.95; envMapIntensity: 1.4; emissive: #8b4513; emissiveIntensity: 0.02"
            animation="property: rotation; to: 0 360 0; dur: 60000; loop: true; easing: linear"
            planet-info="planet: marte"
            class="interactivo"
            orbit="radius: 6500; speed: 0.016; startAngle: 2.1">
        </a-sphere>

        <!-- J√∫piter -->
        <a-sphere 
            id="planeta-jupiter"
            radius="600"
            material="src: #jupiterTexture; shader: standard; metalness: 0.3; roughness: 0.9; envMapIntensity: 1.5; emissive: #ffd700; emissiveIntensity: 0.05"
            animation="property: rotation; to: 0 360 0; dur: 80000; loop: true; easing: linear"
            planet-info="planet: jupiter"
            class="interactivo"
            orbit="radius: 8000; speed: 0.01; startAngle: 2.8">
        </a-sphere>



        <!-- Modelo 3D de Saturno (GLTF) -->
        <a-entity 
            id="saturno-3d"
            scale="5 5 5"
            gltf-model="#saturnModel"
            saturn-textures
            animation="property: rotation; to: 0 360 0; dur: 80000; loop: true; easing: linear"
            planet-info="planet: saturno"
            class="interactivo"
            orbit="radius: 9500; speed: 0.006; startAngle: 3.5">
        </a-entity>

        <!-- OVNI de Bob Lazar -->
        <a-entity 
            id="bob-lazar-ufo"
            position="0 10 0"
            scale="30 30 30"
            gltf-model="#bobLazarUfo"
            ufo-patrol="speed: 0.05"
            ufo-textures>
            <!-- Luz blanca para iluminar el OVNI sin te√±irlo de rojo -->
            <a-light type="point" color="#ffffff" intensity="10" distance="500" decay="2" position="0 18 0"></a-light>
        </a-entity>
        <!-- Luz puntual para iluminar el OVNI -->
        <a-light type="point" color="#a21006" intensity="5" distance="2000" decay="2" position="0 20 0"></a-light>

        <!-- Meteorito flotante y girando -->
        <a-entity 
            id="meteorito-espacial"
            name="meteorito-espacial"
            position="4000 1000 0"
            scale="4 4 4"
            gltf-model="#meteoriteModel"
            animation="property: rotation; to: 0 360 360; dur: 18000; loop: true; easing: linear"
            class="interactivo">
            <a-light type="point" color="#ffae42" intensity="3.5" distance="1200" decay="2" castShadow="false" position="0 0 0"></a-light>
        </a-entity>

        <!-- Urano (restaurado a esfera original) -->
        <a-sphere 
            id="planeta-urano"
            radius="350"
            material="src: #uranusTexture; shader: standard; metalness: 0.2; roughness: 0.8; envMapIntensity: 1.0; emissive: #87ceeb; emissiveIntensity: 0.02"
            animation="property: rotation; to: 0 360 0; dur: 125000; loop: true; easing: linear"
            planet-info="planet: urano"
            class="interactivo"
            orbit="radius: 12000; speed: 0.004; startAngle: 4.1">
            <!-- Anillo vertical de Urano con textura y ajustes personalizados -->
            <a-ring 
                radius-inner="600" 
                radius-outer="450" 
                position="0 0 0"
                rotation="5.385 175.557706174855 -131.27093340021804"
                material="src: url(src/uranus/anillo_uranus.png); color: #808080; transparent: true; opacity: 0.360; side: double;">
            </a-ring>
        </a-sphere>

        <!-- Neptuno -->
        <a-sphere 
            id="planeta-neptuno"
            radius="340"
            material="src: #neptuneTexture; shader: standard; metalness: 0.2; roughness: 0.9; envMapIntensity: 1.1; emissive: #4169e1; emissiveIntensity: 0.03"
            animation="property: rotation; to: 0 360 0; dur: 150000; loop: true; easing: linear"
            planet-info="planet: neptuno"
            class="interactivo"
            orbit="radius: 14000; speed: 0.002; startAngle: 4.7">
        </a-sphere>



        <!-- Objetos decorativos en el escenario -->
        
        <!-- Mesa en el centro -->
        <a-box 
            id="mueble-mesa"
            position="0 0.5 0" 
            width="2" 
            height="1" 
            depth="1" 
            color="#8B4513">
        </a-box>

        <!-- Silla -->
        <a-box 
            id="mueble-silla"
            position="0 0.25 -2" 
            width="0.8" 
            height="0.5" 
            depth="0.8" 
            color="#654321">
        </a-box>

        <!-- L√°mpara en la mesa -->
        <a-cylinder 
            id="lampara-base"
            position="0 1.2 0" 
            radius="0.1" 
            height="0.4" 
            color="#FFD700">
        </a-cylinder>

        <!-- Luz de la l√°mpara -->
        <a-light 
            id="luz-lampara"
            type="point" 
            position="0 1.5 0" 
            color="#FFD700" 
            intensity="1" 
            distance="5">
        </a-light>

        <!-- Ventana en la pared frontal -->
        <a-plane 
            id="ventana-cristal"
            position="0 2.5 4.9" 
            rotation="0 180 0" 
            width="2" 
            height="1.5" 
            color="#87CEEB">
        </a-plane>

        <!-- Marco de la ventana -->
        <a-plane 
            id="ventana-marco"
            position="0 2.5 4.95" 
            rotation="0 180 0" 
            width="2.2" 
            height="1.7" 
            color="#8B4513">
        </a-plane>

        <!-- Cuadro en la pared -->
        <a-plane 
            id="cuadro-pintura"
            position="-4.9 2.5 0" 
            rotation="0 90 0" 
            width="1.5" 
            height="1" 
            color="#FF6B6B">
        </a-plane>

        <!-- Marco del cuadro -->
        <a-plane 
            id="cuadro-marco"
            position="-4.95 2.5 0" 
            rotation="0 90 0" 
            width="1.7" 
            height="1.2" 
            color="#8B4513">
        </a-plane>

        <!-- Panel informativo HTML flotante -->
        <div id="planet-info-panel" style="display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.92);color:white;z-index:10000;padding:30px 40px;border-radius:15px;max-width:500px;text-align:center;box-shadow:0 0 20px #000a;">
          <h2 id="planet-info-title" style="margin-bottom:15px;"></h2>
          <p id="planet-info-text" style="font-size:1.1rem;line-height:1.6;"></p>
          <button id="close-info-btn" style="margin-top:20px;padding:10px 30px;border-radius:8px;background:#b00;color:white;font-size:1rem;border:none;cursor:pointer;">Cerrar</button>
        </div>
        <script>
        // Diccionario de curiosidades por planeta
        const planetCuriosities = {
          sol: { title: "‚òÄÔ∏è EL SOL", info: "Nuestra estrella central. Temperatura: 5,500¬∞C en la superficie, 15 millones¬∞C en el n√∫cleo. Curiosidades: En su n√∫cleo se fusionan 600 millones de toneladas de hidr√≥geno cada segundo. La luz solar tarda 8 minutos en llegar a la Tierra. El Sol contiene el 99.86% de toda la masa del sistema solar. Su gravedad es 28 veces mayor que la de la Tierra. El Sol rota m√°s r√°pido en su ecuador que en sus polos. Una mancha solar puede ser m√°s grande que la Tierra." },
          mercurio: { title: "‚òø MERCURIO", info: "El planeta m√°s cercano al Sol. Temperatura: -180¬∞C a 430¬∞C. Curiosidades: Un d√≠a en Mercurio dura 59 d√≠as terrestres, pero un a√±o dura solo 88 d√≠as terrestres. No tiene lunas ni anillos. Su superficie est√° llena de cr√°teres por impactos de meteoritos. Es el planeta m√°s peque√±o del sistema solar. Su n√∫cleo de hierro ocupa el 75% de su volumen. No tiene atm√≥sfera, por lo que no hay viento ni sonido." },
          venus: { title: "‚ôÄ VENUS", info: "El planeta m√°s caliente del sistema solar. Temperatura: 462¬∞C. Curiosidades: Venus gira en direcci√≥n contraria a la mayor√≠a de planetas. Su atm√≥sfera es 90 veces m√°s densa que la de la Tierra. Un d√≠a en Venus dura m√°s que un a√±o venusiano. Es el planeta m√°s brillante visto desde la Tierra. Tiene m√°s volcanes que cualquier otro planeta. Su superficie est√° oculta por nubes de √°cido sulf√∫rico." },
          tierra: { title: "üåç LA TIERRA", info: "Nuestro hogar. Temperatura promedio: 15¬∞C. Curiosidades: La Tierra es el √∫nico planeta conocido con vida. El 71% de su superficie est√° cubierta de agua. Es el √∫nico planeta con placas tect√≥nicas activas. La Luna es el sat√©lite natural m√°s grande en relaci√≥n a su planeta. El campo magn√©tico terrestre nos protege de la radiaci√≥n solar. La Tierra no es perfectamente esf√©rica, est√° achatada en los polos." },
          marte: { title: "‚ôÇ MARTE", info: "El planeta rojo. Temperatura: -140¬∞C a 20¬∞C. Curiosidades: Marte tiene la monta√±a m√°s alta del sistema solar: el Monte Olimpo, con 22 km de altura. Sus d√≠as duran 24 horas y 37 minutos. Tiene el ca√±√≥n m√°s grande del sistema solar: Valles Marineris. Sus polos tienen casquetes de hielo de di√≥xido de carbono. La gravedad en Marte es solo el 38% de la terrestre. Tiene dos lunas peque√±as: Fobos y Deimos." },
          jupiter: { title: "‚ôÉ J√öPITER", info: "El planeta m√°s grande. Temperatura: -110¬∞C. Curiosidades: J√∫piter tiene 79 lunas conocidas. La Gran Mancha Roja es una tormenta que lleva activa m√°s de 300 a√±os. Es tan masivo que podr√≠a tragarse todos los dem√°s planetas. Su d√≠a dura solo 10 horas terrestres. Tiene un sistema de anillos muy tenue. Su luna Gan√≠medes es m√°s grande que Mercurio. J√∫piter emite m√°s calor del que recibe del Sol." },
          saturno: { title: "‚ôÑ SATURNO", info: "El planeta de los anillos. Temperatura: -140¬∞C. Curiosidades: Los anillos de Saturno est√°n compuestos principalmente de hielo y roca. Tienen solo 10 metros de grosor pero 280,000 km de di√°metro. Es el planeta menos denso del sistema solar. Tiene 82 lunas confirmadas. Su luna Tit√°n es la segunda m√°s grande del sistema solar. Los anillos de Saturno tienen 'pastores' que mantienen su forma. Es el √∫nico planeta visible a simple vista que no era conocido en la antig√ºedad." },
          urano: { title: "‚ôÖ URANO", info: "El planeta inclinado. Temperatura: -195¬∞C. Curiosidades: Urano gira de lado, con su eje inclinado 98 grados. Sus anillos son verticales en lugar de horizontales. Fue el primer planeta descubierto con telescopio. Tiene 27 lunas conocidas. Su color azul se debe al metano en su atm√≥sfera. Un a√±o en Urano dura 84 a√±os terrestres. Sus anillos son muy oscuros y dif√≠ciles de ver." },
          neptuno: { title: "‚ôÜ NEPTUNO", info: "El planeta m√°s lejano. Temperatura: -200¬∞C. Curiosidades: Neptuno tiene los vientos m√°s fuertes del sistema solar, alcanzando 2,100 km/h. Fue descubierto matem√°ticamente antes de ser observado. Tiene 14 lunas conocidas. Su luna Trit√≥n orbita en direcci√≥n contraria. Un a√±o en Neptuno dura 165 a√±os terrestres. Es el planeta m√°s fr√≠o del sistema solar. Su color azul intenso se debe al metano en su atm√≥sfera." },
          luna: { title: "üåô LA LUNA", info: "La Luna es el √∫nico sat√©lite natural de la Tierra. Su gravedad causa las mareas. Siempre muestra la misma cara hacia la Tierra. Su superficie est√° cubierta de cr√°teres. No tiene atm√≥sfera significativa. Es el quinto sat√©lite m√°s grande del sistema solar." }
        };
        // Asignar eventos de clic a todos los planetas y Saturno 3D
        window.addEventListener('DOMContentLoaded', function() {
          // Solo planetas (sin el Sol) deben ser interactivos
          const planetIds = [
            'planeta-mercurio',
            'planeta-venus',
            'planeta-tierra',
            'satelite-luna',
            'planeta-marte',
            'planeta-jupiter',
            'saturno-3d',
            'planeta-urano',
            'planeta-neptuno'
          ];
          planetIds.forEach(function(id) {
            const el = document.getElementById(id);
            if (el) {
              el.addEventListener('click', function() {
                let planet = el.getAttribute('planet-info')?.planet || el.getAttribute('planet-info') || id.replace('planeta-','').replace('saturno-3d','saturno').replace('satelite-luna','luna');
                const data = planetCuriosities[planet];
                if (data) {
                  document.getElementById('planet-info-title').textContent = data.title;
                  document.getElementById('planet-info-text').innerHTML = data.info;
                  document.getElementById('planet-info-panel').style.display = 'block';
                }
              });
            }
          });
          // Agregar tambi√©n el Sol como interactivo SOLO si el raycaster realmente intersecta el modelo
          const sol = document.getElementById('sol-nucleo');
          const scene = document.querySelector('a-scene');
          if (sol && scene) {
            scene.addEventListener('click', function(e) {
              // Obtener el cursor de la c√°mara
              const camera = scene.querySelector('a-camera');
              if (camera && camera.components && camera.components.cursor) {
                const intersected = camera.components.cursor.intersectedEl;
                if (intersected === sol) {
                  const data = planetCuriosities['sol'];
                  if (data) {
                    document.getElementById('planet-info-title').textContent = data.title;
                    document.getElementById('planet-info-text').innerHTML = data.info;
                    document.getElementById('planet-info-panel').style.display = 'block';
                  }
                }
              }
            });
          }
          // Asignar el evento de cerrar solo una vez y evitar propagaci√≥n
          document.getElementById('close-info-btn').onclick = function(event) {
            event.stopPropagation();
            document.getElementById('planet-info-panel').style.display = 'none';
          };
        });
        // Evento informativo al hacer click en el OVNI
        window.addEventListener('DOMContentLoaded', function() {
          var ufo = document.getElementById('bob-lazar-ufo');
          if (ufo) {
            ufo.addEventListener('click', function(event) {
              event.stopPropagation();
              // Si ya existe el panel, no crear otro
              if (document.getElementById('ufo-info-panel')) {
                document.getElementById('ufo-info-panel').style.display = 'block';
                return;
              }
              // Crear panel informativo similar al de los planetas
              var panel = document.createElement('div');
              panel.id = 'ufo-info-panel';
              panel.style.cssText = 'display:block;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.92);color:white;z-index:10000;padding:30px 40px;border-radius:15px;max-width:500px;text-align:center;box-shadow:0 0 20px #000a;';
              panel.innerHTML = `
                <h2 style="margin-bottom:15px;">üëΩ MENSAJE DEL OVNI</h2>
                <p style="font-size:1.1rem;line-height:1.6;">Espero que nuestro amigo Jorge Bastori cumpla con su infiltraci√≥n como terricola... Mientras tanto seguiremos consumiendo los recursos de este sistema solar a escondidas.. Muahahaha.
                  https://github.com/jortecs </p> 
                <button id="close-ufo-info-btn" style="margin-top:20px;padding:10px 30px;border-radius:8px;background:#b00;color:white;font-size:1rem;border:none;cursor:pointer;">Cerrar</button>
              `;
              document.body.appendChild(panel);
              document.getElementById('close-ufo-info-btn').onclick = function(event) {
                event.stopPropagation();
                panel.style.display = 'none';
              };
            });
          }
        });
        </script>

    </a-scene>

    <script>
// --- Pointer Lock helpers ---
function exitPointerLock() {
  if (document.exitPointerLock) {
    document.exitPointerLock();
  } else if (document.mozExitPointerLock) {
    document.mozExitPointerLock();
  } else if (document.webkitExitPointerLock) {
    document.webkitExitPointerLock();
  }
}
function requestPointerLock() {
  var scene = document.querySelector('a-scene').canvas;
  if (scene && scene.requestPointerLock) {
    scene.requestPointerLock();
  } else if (scene && scene.mozRequestPointerLock) {
    scene.mozRequestPointerLock();
  } else if (scene && scene.webkitRequestPointerLock) {
    scene.webkitRequestPointerLock();
  }
}

// --- Pantalla de pausa ---
// Eliminar el div con id="pantalla-pausa" y toda la l√≥gica JS asociada a la pausa (mostrarPausa, ocultarPausa, btnContinuar, etc).

// Atajos de teclado para pausar/continuar
window.addEventListener('keydown', function(e) {
  // Eliminar la l√≥gica de pausa de teclado
});
// Si el usuario sale del pointer lock manualmente, mostrar pausa
if ("onpointerlockchange" in document) {
  document.addEventListener('pointerlockchange', function() {
    var scene = document.querySelector('a-scene').canvas;
    // Eliminar la l√≥gica de pausa de pointer lock
  });
}

// Detectar m√≥vil/t√°ctil
function isMobile() {
  return /Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop|Mobile|Tablet/i.test(navigator.userAgent) || (window.matchMedia && window.matchMedia('(pointer: coarse)').matches);
}

if (isMobile()) {
  document.getElementById('mobile-controls').style.display = 'block';
  // Habilitar look-controls t√°ctil en m√≥vil
  var cameraEl = document.querySelector('a-camera');
  if (cameraEl && cameraEl.components && cameraEl.components["look-controls"]) {
    cameraEl.components["look-controls"].data.touchEnabled = true;
    cameraEl.components["look-controls"].updateProperties();
  }
  // Joystick izquierdo: rotaci√≥n de c√°mara
  var joystickLeft = nipplejs.create({
    zone: document.getElementById('joystick-left'),
    mode: 'static',
    position: {left: '60px', bottom: '60px'},
    color: 'white',
    size: 100,
    restOpacity: 0.5
  });
  // Joystick derecho: movimiento
  var joystickRight = nipplejs.create({
    zone: document.getElementById('joystick-right'),
    mode: 'static',
    position: {right: '60px', bottom: '60px'},
    color: 'white',
    size: 100,
    restOpacity: 0.5
  });
  // Referencias a la c√°mara y entidad de usuario
  var entityEl = cameraEl.parentEl;
  // Variables para movimiento
  var move = {x:0, y:0};
  var rotate = {x:0, y:0};
  // Movimiento con joystick derecho
  joystickRight.on('move', function(evt, data) {
    var rad = data.angle.radian;
    var force = Math.min(data.force, 1);
    move.x = Math.cos(rad) * force;
    move.y = Math.sin(rad) * force;
  });
  joystickRight.on('end', function() { move.x = 0; move.y = 0; });
  // Rotaci√≥n con joystick izquierdo
  joystickLeft.on('move', function(evt, data) {
    var rad = data.angle.radian;
    var force = Math.min(data.force, 1);
    rotate.x = Math.cos(rad) * force;
    rotate.y = Math.sin(rad) * force;
  });
  joystickLeft.on('end', function() { rotate.x = 0; rotate.y = 0; });
  // Acci√≥n: click/interactuar
  document.getElementById('mobile-action').addEventListener('touchstart', function(e) {
    e.preventDefault();
    // Simular click en el objeto bajo el centro de la pantalla
    var scene = document.querySelector('a-scene');
    var cursor = cameraEl.components.cursor;
    if (cursor && cursor.intersectedEl) {
      cursor.intersectedEl.emit('click');
    }
  });
  // Loop para aplicar movimiento y rotaci√≥n
  AFRAME.registerComponent('mobile-controls', {
    tick: function() {
      // Movimiento (traslaci√≥n)
      if (move.x !== 0 || move.y !== 0) {
        var angle = cameraEl.getAttribute('rotation').y * Math.PI / 180;
        var dx = move.y * Math.sin(angle) + move.x * Math.cos(angle);
        var dz = move.y * Math.cos(angle) - move.x * Math.sin(angle);
        var pos = entityEl.getAttribute('position');
        pos.x += dx * 2;
        pos.z += dz * 2;
        entityEl.setAttribute('position', pos);
      }
      // Rotaci√≥n (c√°mara)
      if (rotate.x !== 0 || rotate.y !== 0) {
        var rot = cameraEl.getAttribute('rotation');
        rot.y -= rotate.x * 2.5;
        rot.x -= rotate.y * 2.5;
        rot.x = Math.max(-90, Math.min(90, rot.x));
        cameraEl.setAttribute('rotation', rot);
      }
    }
  });
  cameraEl.setAttribute('mobile-controls', '');
}
</script>
</body>
</html> 